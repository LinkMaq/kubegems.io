---
title: 微服务治理
hide_title: true
sidebar_position: 5
---
## 基于Istio的微服务网格

--- 

### 服务治理

<img src="/img/docs/service-mesh.jpg" width="100%" />

#### 流量管理

通过在KubeGems中创建虚拟空间开启对 Istio 功能支持，开启微服务治理的应用依靠Istio Sidecar会拦截微服务之间的所有网络通信，然后使用其控制平面的功能来配置和管理，这包括：

- **负载均衡:** 为 HTTP、gRPC、WebSocket 和 TCP 流量自动负载均衡

- **访问控制:** 通过丰富的路由规则、重试、故障转移和故障注入对流量行为进行细粒度控制

- **流量控制:** 可插拔的策略层和配置 API，支持访问控制、速率限制和配额

#### 安全

身份是任何安全基础架构的基本概念。在工作负载间通信开始时，双方必须交换包含身份信息的凭证以进行双向验证。

- **丰富的认证策略:** 使用 peer 和 request 认证策略为在 Istio 网格中接收请求的工作负载指定认证要求

- **自定义应用授权:** 每个代理都运行一个授权引擎，该引擎在运行时授权请求。当请求到达代理时，授权引擎根据当前授权策略评估请求上下文，并返回授权结果 ALLOW 或 DENY

- **公钥基础设施 (PKI):** 使用 X.509 证书为每个工作负载都提供强大的身份标识
#### 可观察性

KubeGems的虚拟空间内生成了内部服务通信的详细遥测数据。使用户能够排查故障、维护和优化应用程序。

- **应用指标:** 基于 4 个监控的黄金标识（延迟、流量、错误、饱和）生成了一系列服务指标

- **分布式追踪:**  为每个服务生成分布式追踪 span，用户可以理解网格内服务的依赖和调用流程

- **访问日志:** 记录应用流量生成请求的完整记录，包括源和目标的元数据


### 微服务网关

<img src="/img/docs/api-gateway-basic.jpg" width="90%" align="center" />

KubeGems 提供微服务网关以满足应用南北向流量的代理,网关分为**基础版(Basic Nginx)**和**微服务版(Mesh Istio)**。

#### 基础版网关

- 支持服务路由管理

- 应用负载均衡

- 应用监控统计

#### 微服务网关

- 基础网关所有功能

- 支持应用流量细粒度控制

- 支持应用蓝绿发布、灰度发布等高级策略
